{"name":"Methpat","tagline":"A program for summarising CpG methylation patterns","body":"### Introduction\r\n\r\nThis program summarises the resultant DNA methylation pattern data from the output of [Bismark](http://www.bioinformatics.babraham.ac.uk/projects/bismark/) bismark_methylation_extractor. Information of the DNA methylation positions for each amplicon, DNA methylation patterns observed within each amplicon and their abundance counts are summarised into a tab delimited text file amenable for further downstream statistical analysis and visualization.\r\n\r\n## Requirements\r\n\r\n* Whole genome bisulfite short read sequencing data (WGBS), or Reduced Representation Bisulfite Sequencing (RRBS), or Bisulfite Amplicon Sequencing.\r\n* Bismark v0.12.2 and it’s dependencies (bwa v0.7.5a-r405).\r\n* Python 2.7 or above (but not Python 3).\r\n* Methpat and it’s dependencies [https://github.com/bjpop/methpat](https://github.com/bjpop/methpat).\r\n* A modern web browser such as Chrome, Firefox or Safari.\r\n\r\n## Installation\r\n\r\nMethpat currently requires version 2.7 of Python.\r\n\r\nThe best way to install Methpat is to use the following command:\r\n\r\n    pip install git+https://github.com/bjpop/methpat.git\r\n\r\nThis will automatically download and install the dependencies of methpat.\r\n\r\n## Usage\r\n\r\n    usage: methpat [-h] [--dump_reads FILE] [--count_thresh THRESH] --amplicons\r\n                   AMPLICONS_FILE --logfile FILENAME --html FILENAME\r\n                   [--webassets {package,local,online}] [--title TITLE]\r\n                   BISMARK_FILE\r\n    \r\n    Count methylation patterns in bismark output\r\n    \r\n    positional arguments:\r\n      BISMARK_FILE          input bismark file\r\n    \r\n    optional arguments:\r\n      -h, --help            show this help message and exit\r\n      --dump_reads FILE     dump the read methylation information to FILE\r\n      --count_thresh THRESH\r\n                            only display methylation patterns with at least THRESH\r\n                            number of matching reads\r\n      --amplicons AMPLICONS_FILE\r\n                            file containing amplicon information in TSV format\r\n      --logfile FILENAME    log progress in FILENAME\r\n      --html FILENAME       save visualisation in html FILENAME\r\n      --webassets {package,local,online}\r\n                            location of assets used by output visualisation web\r\n                            page, defaults to package\r\n      --title TITLE         title of the output visualisation page, defaults to\r\n                            Methylation Patterns\r\n\r\n## Explanation of arguments\r\n\r\n* **--dump_reads FILE**: Dump the read methylation information to FILE.\r\n* **--count_thresh THRESH**: Only display methylation patterns with at least THRESH number of matching reads.\r\n* **--amplicons AMPLICONS_FILE**: Input file containing amplicon information in TSV format.\r\n* **--logfile FILENAME**: Output log progress in FILENAME.\r\n* **--html FILENAME**: Save visualisation in html FILENAME.\r\n* **--webassets {package,local,online}**: Location of assets used by output visualisation web page, defaults to package.\r\n* **--title TITLE**: Title of the output visualisation page, defaults to \"Methylation Patterns\".\r\n\r\n## Amplicons File Definintion\r\n\r\nThe amplicons or regions of interest are defined by this tab-delimited text file. The order\r\nof regions listed in this file will correspond to the order of display in the html file generated.\r\nThe file requires 7 columns which define:\r\n\r\n1. chromosome\r\n2. start coordinate of amplicon/region of interest\r\n3. end coordinate of amplicon/region of interest\r\n4. name of amplicon/region of interest\r\n5. size of amplicon/region of interest\r\n6. length of forward PCR primer of amplicon/region of interest, number of base pairs to ignore from the start\r\n7. length of reverse PCR primer of amplicon/region of interest, number of base pairs to ignore from the end\r\n\r\nSee the file `examples/example_amplicons.txt` for a working example.\r\n\r\n## Worked example\r\n\r\nRun Bismark as per instructions to prepare the reference genome as outlined in the [bismark manual](http://www.bioinformatics.babraham.ac.uk/projects/bismark/Bismark_User_Guide.pdf).\r\n\r\nRun Bismark to align raw read files (fastq) as below with no mismatches:\r\n\r\n```\r\nbismark -n 0 -q -o <nameOfOutPutDirectory> --bam --ambiguous --chunkmbs 10204 --non_directional /path/to/reference/genome <fastq.file>\r\n```\r\n\r\nRun bismark methylation extractor to create an output text file containing read DNA\r\nmethylation pattern information:\r\n\r\n```\r\nbismark_methylation_extractor -s <bismarkAlignedFileName.bam>\r\n```\r\n\r\nThis creates a series of text files prefixed with the methylation orientation and reference\r\ngenome strand data was extracted from. For the purposes here, the files prefixed with CpG\r\nare then processed with methpat.\r\n\r\nFor each bismark output file with a `bismark.txt` suffix, run the following command to generate the methpat output. The example below uses the data files in the examples directory of the methpat source package:\r\n\r\n```\r\nmethpat --amplicons example_amplicons.txt example1_bismark.txt > example_methpat.txt\r\n```\r\n\r\nThe above example generates three output files:\r\n\r\n1. `examle_methpat.txt`: summarises the read count and DNA methylation pattern information for all amplicons/regions of interest listed in the amplicons file.\r\n2. `methpat.log`: log information about the progress of the methpat program (useful for debugging purposes if things don't work as you expect, also records the command line that was used just in case you want to run the exact same command again).\r\n3. `methpat.html`: interactive HTML visualisation of the methylation patterns for each amplicon/region of interest. This is best viewed in Chrome, Firefox and Safari (but not Internet Explorer).","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}